<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.8">
<meta name="author" content="Gunnar Hillert">
<title>Coherence Spring Reference Documentation</title>
<link rel="stylesheet" href="css/spring.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<style>
.hidden {
	display: none;
}

.switch {
	border-width: 1px 1px 0 1px;
	border-style: solid;
	border-color: #7a2518;
	display: inline-block;
}

.switch--item {
	padding: 10px;
	background-color: #ffffff;
	color: #7a2518;
	display: inline-block;
	cursor: pointer;
}

.switch--item:not(:first-child) {
	border-width: 0 0 0 1px;
	border-style: solid;
	border-color: #7a2518;
}

.switch--item.selected {
	background-color: #7a2519;
	color: #ffffff;
}
</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/zepto/1.2.0/zepto.min.js"></script>
<script type="text/javascript">
function addBlockSwitches() {
	$('.primary').each(function() {
		primary = $(this);
		createSwitchItem(primary, createBlockSwitch(primary)).item.addClass("selected");
		primary.children('.title').remove();
	});
	$('.secondary').each(function(idx, node) {
		secondary = $(node);
		primary = findPrimary(secondary);
		switchItem = createSwitchItem(secondary, primary.children('.switch'));
		switchItem.content.addClass('hidden');
		findPrimary(secondary).append(switchItem.content);
		secondary.remove();
	});
}

function createBlockSwitch(primary) {
	blockSwitch = $('<div class="switch"></div>');
	primary.prepend(blockSwitch);
	return blockSwitch;
}

function findPrimary(secondary) {
	candidate = secondary.prev();
	while (!candidate.is('.primary')) {
		candidate = candidate.prev();
	}
	return candidate;
}

function createSwitchItem(block, blockSwitch) {
	blockName = block.children('.title').text();
	content = block.children('.content').first().append(block.next('.colist'));
	item = $('<div class="switch--item">' + blockName + '</div>');
	blockSwitch.append(item);
	return {'item': item, 'content': content};
}

function globalSwitch() {
	$('.switch--item').each(function() {
		var blockId = blockIdForSwitchItem($(this));
		$(this).off('click');
		$(this).on('click', function() {
			selectedText = $(this).text()
			window.localStorage.setItem(blockId, selectedText);
			$(".switch--item").filter(function() {
				return blockIdForSwitchItem($(this)) === blockId;
			}).filter(function() {
				return $(this).text() === selectedText;
			}).each(function() {
				select($(this))
			});
		});
		if ($(this).text() === window.localStorage.getItem(blockId)) {
			select($(this))
		}
	});
}

function blockIdForSwitchItem(item) {
	idComponents = []
	idComponents.push(item.text().toLowerCase());
	item.siblings(".switch--item").each(function(index, sibling) {
		idComponents.push($(sibling).text().toLowerCase());
	});
	return idComponents.sort().join("-")
}

function select(selected) {
	selected.addClass('selected');
	selected.siblings().removeClass('selected');
	selectedContent = selected.parent().siblings(".content").eq(selected.index())
	selectedContent.removeClass('hidden');
	selectedContent.siblings().addClass('hidden');
}

$(addBlockSwitches);
$(globalSwitch);

</script>

</head>
<body id="coherence-spring-reference-documentation" class="book toc2 toc-left">
<div id="header">
<h1>Coherence Spring Reference Documentation</h1>
<div class="details">
<span id="author" class="author">Gunnar Hillert</span><br>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#legal">Legal</a></li>
<li><a href="#coherence-spring-documentation">1. Coherence Spring Documentation</a>
<ul class="sectlevel2">
<li><a href="#about">1.1. About the Documentation</a></li>
<li><a href="#getting-help">1.2. Getting Help</a></li>
<li><a href="#news">1.3. What is new?</a></li>
<li><a href="#first-steps">1.4. First Steps</a></li>
</ul>
</li>
<li><a href="#quickstart">2. Quickstart</a>
<ul class="sectlevel2">
<li><a href="#how-to-run-the-demo">2.1. How to Run the Demo</a></li>
<li><a href="#interacting-with-the-cache">2.2. Interacting with the Cache</a></li>
<li><a href="#behind-the-scenes">2.3. Behind the Scenes</a></li>
</ul>
</li>
<li><a href="#coherence-spring">3. Coherence Spring Core</a>
<ul class="sectlevel2">
<li><a href="#coherence-spring-introduction">3.1. Getting Started</a></li>
</ul>
</li>
<li><a href="#spring-cache">4. Coherence Spring Cache</a>
<ul class="sectlevel2">
<li><a href="#spring-cache-introduction">4.1. Introduction</a></li>
<li><a href="#spring-cache-configuration">4.2. Configuring Coherence Cache for Spring</a></li>
</ul>
</li>
<li><a href="#spring-session">5. Coherence Spring Session</a>
<ul class="sectlevel2">
<li><a href="#spring-session-introduction">5.1. Getting Started</a></li>
</ul>
</li>
<li><a href="#spring-data">6. Coherence Spring Data</a>
<ul class="sectlevel2">
<li><a href="#spring-data-introduction">6.1. Getting Started</a></li>
</ul>
</li>
<li><a href="#spring-boot">7. Coherence Spring Boot</a>
<ul class="sectlevel2">
<li><a href="#spring-boot-getting-started">7.1. Getting Started</a></li>
<li><a href="#spring-boot-using-coherence">7.2. Using Coherence with Spring Boot</a></li>
<li><a href="#spring-boot-customize-coherence">7.3. Customize Coherence</a></li>
<li><a href="#spring-boot-caching">7.4. Using Coherence as Spring Caching Provider</a></li>
</ul>
</li>
<li><a href="#appendix">8. Appendices</a></li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Version 3.0.0-SNAPSHOT</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="legal"><a class="anchor" href="#legal"></a>Legal</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Oracle licenses the Oracle Coherence Spring project under the
<a href="https://oss.oracle.com/licenses/upl/">The Universal Permissive License (UPL), Version 1.0</a>.</p>
</div>
<div class="paragraph">
<p><strong>The Universal Permissive License (UPL), Version 1.0</strong></p>
</div>
<div class="paragraph">
<p>Subject to the condition set forth below, permission is hereby granted to any
person obtaining a copy of this software, associated documentation and/or data
(collectively the "Software"), free of charge and under any and all copyright
rights in the Software, and any and all patent rights owned or freely
licensable by each licensor hereunder covering either (i) the unmodified
Software as contributed to or provided by such licensor, or (ii) the Larger
Works (as defined below), to deal in both</p>
</div>
<div class="paragraph">
<p>(a) the Software, and
(b) any piece of software and/or hardware listed in the lrgrwrks.txt file if
one is included with the Software (each a "Larger Work" to which the Software
is contributed by such licensors),</p>
</div>
<div class="paragraph">
<p>without restriction, including without limitation the rights to copy, create
derivative works of, display, perform, and distribute the Software and make,
use, sell, offer for sale, import, export, have made, and have sold the
Software and the Larger Work(s), and to sublicense the foregoing rights on
either these or other terms.</p>
</div>
<div class="paragraph">
<p>This license is subject to the following condition:
The above copyright notice and either this complete permission notice or at
a minimum a reference to the UPL must be included in all copies or
substantial portions of the Software.</p>
</div>
<div class="paragraph">
<p>THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="coherence-spring-documentation"><a class="anchor" href="#coherence-spring-documentation"></a>1. Coherence Spring Documentation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Welcome to the reference documentation of <a href="https://github.com/coherence-community/coherence-spring">Coherence Spring</a>, a collection of several
libraries that will help you to integrate <a href="https://coherence.community">Coherence</a> with the wider <a href="https://spring.io">Spring</a> ecosystem.</p>
</div>
<div class="paragraph">
<p>This section provides a brief overview of the Coherence Spring reference documentation.</p>
</div>
<div class="sect2">
<h3 id="about"><a class="anchor" href="#about"></a>1.1. About the Documentation</h3>
<div class="paragraph">
<p>The Coherence Spring reference guide is available as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://spring.coherence.community//3.0.0-SNAPSHOT/refdocs/reference/html">Multi-page HTML</a></p>
</li>
<li>
<p><a href="http://spring.coherence.community//3.0.0-SNAPSHOT/refdocs/reference/htmlsingle">Single page HTML</a></p>
</li>
<li>
<p><a href="http://spring.coherence.community//3.0.0-SNAPSHOT/refdocs/reference/pdf/coherence-spring-reference.pdf">PDF</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="getting-help"><a class="anchor" href="#getting-help"></a>1.2. Getting Help</h3>
<div class="paragraph">
<p>If you run into issues with Spring Coherence, we are here to help.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>Try the <a href="#quickstart">Quickstart</a>.</em>
The Quickstart will give you an overview of Coherence Spring&#8217;s
capabilities and provides a sample application to get you started.</p>
</li>
<li>
<p><em>Learn the Coherence basics.</em> Please have at least some basic understanding of Oracle Coherence since all Spring Coherence
modules depend on it. Check out the <a href="https://coherence.community">Coherence CE</a> web-site for general Coherence
targeted reference documentation.</p>
</li>
<li>
<p><em>Learn the Spring basics.</em>
The reference guide assumes that you have a basic understanding of <a href="https://spring.io/projects/spring-framework">Spring Framework</a> and
<a href="https://spring.io/projects/spring-boot">Spring Boot</a>. Coherence Spring utilizes several other Spring projects. Check the
<a href="https://spring.io/">spring.io</a> web-site for general reference documentation. If you are starting out with Spring, try
one of the <a href="https://spring.io/guides">guides</a> or generate a starter project using <a href="https://start.spring.io/" class="bare">start.spring.io/</a>.</p>
</li>
<li>
<p><em>Ask a question.</em>
Chat with us directly on <a href="https://join.slack.com/t/oraclecoherence/shared_invite/zt-9ufv220y-Leudk0o5ntgNV0xraa8DNw">Slack</a>.
We also monitor <a href="https://stackoverflow.com">stackoverflow.com</a> for questions tagged with
<a href="https://stackoverflow.com/tags/oracle-coherence">oracle-coherence</a>.</p>
</li>
<li>
<p><em>Contribute.</em>
Report bugs with Spring Coherence via <a href="https://github.com/coherence-community/coherence-spring/issues/">GitHub Issues</a>. Both, Coherence CE and Coherence Spring are Open
Source Software (OSS) under the liberal <a href="#legal">Universal Permissive License (UPL)</a>. Contributing back is
a great way to attain a deeper understanding of our projects.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
All of <em>Coherence Spring</em> is open source, including the documentation.
If you find problems with the docs or if you want to improve them, please <a href="https://github.com/coherence-community/coherence-spring">get involved</a>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="news"><a class="anchor" href="#news"></a>1.3. What is new?</h3>
<div class="paragraph">
<p>In order to see what changes were made from earlier versions of Coherence Spring, see the
<a href="http://spring.coherence.community//3.0.0-SNAPSHOT//history.html">Change History</a> as well as the <a href="https://github.com/coherence-community/coherence-spring/releases">GitHub Releases</a> page.</p>
</div>
</div>
<div class="sect2">
<h3 id="first-steps"><a class="anchor" href="#first-steps"></a>1.4. First Steps</h3>
<div class="paragraph">
<p>If you are getting started with Coherence Spring, start with the <a href="#quickstart">Quickstart</a>. It is a great
way to see a working solution quickly. Particularly if you are relatively new to Spring, continue with the
<a href="#spring-boot">Coherence Spring Boot</a> chapter next. The reference documentation makes a distinction between
<a href="https://spring.io/projects/spring-framework">Spring Framework</a> and <a href="https://spring.io/projects/spring-boot">Spring Boot</a>. At its very core, Spring Framework provides
Dependency Injection (DI) or Inversion Of Control (IOC) to Java applications. Furthermore, Spring Framework gives deveopers
comprehensive infrastructure support for developing Java applications.</p>
</div>
<div class="paragraph">
<p>Spring Boot on the other hand, is an opinionated extension to the Spring Framework by:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Eliminating boilerplate configurations</p>
</li>
<li>
<p>Providing Auto-Configuration for other Spring modules and third-party integrations</p>
</li>
<li>
<p>Metrics + health checks</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The vast majority of new Spring projects will utilize Spring Boot. Nonetheless, please also study the Spring Framework targeted
chapters as Spring Frameworks is the foundation for everything related to Spring Boot.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="quickstart"><a class="anchor" href="#quickstart"></a>2. Quickstart</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this getting started chapter we will look a demo to illustrate basic usage of Oracle Coherence when using it with
Spring. This demo provides an example of using Coherence Spring&#8217;s
<a href="https://docs.spring.io/spring-framework/docs/current/reference/html/integration.html#cache">Cache Abstraction</a>.</p>
</div>
<div class="paragraph">
<p>The demo application is basically a super-simple event manager. We can create <code>Events</code> and assign <code>People</code> to them using
an exposed REST API. The data is saved in an embedded HSQL database. The caching is implemented at the service layer:</p>
</div>
<div class="paragraph">
<p>When an <code>Event</code> is created, it is not only persisted to the database but also <em>put</em> to the Coherence Cache.
Therefore, whenever an <code>Event</code> is retrieved, it will be returned from the Coherence Cache. You can also delete
<code>Events</code>, in which case the <code>Event</code> will be <em>evicted</em> from the cache. You can perform the same
<a href="https://en.wikipedia.org/wiki/Create,_read,_update_and_delete">CRUD</a> operations for people as well.</p>
</div>
<div class="sect2">
<h3 id="how-to-run-the-demo"><a class="anchor" href="#how-to-run-the-demo"></a>2.1. How to Run the Demo</h3>
<div class="paragraph">
<p>In order to get started, please checkout the code from the <a href="https://github.com/ghillert/coherence-spring-demo">Coherence Spring Demo</a>
GitHub repository.</p>
</div>
<div class="listingblock">
<div class="title">Clone GitHub Repository</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell"> $ git clone https://github.com/ghillert/coherence-spring-demo.git
 $ cd coherence-spring-demo</code></pre>
</div>
</div>
<div class="paragraph">
<p>This repository contains a Maven project consisting of 3 modules. The first two Maven modules are essentially variations of
the same app. The third module contains shared code.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>coherence-spring-demo-classic</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provides a demo using <strong>Spring Framework</strong> without Spring Boot</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>coherence-spring-demo-boot</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provides a demo using <strong>Spring Boot</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>coherence-spring-demo-core</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Contains common code shared between the two apps</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>In this chapter we will focus on the <strong>Spring Boot</strong> version. Since we checked out the project, let&#8217;s build it using Maven:</p>
</div>
<div class="listingblock">
<div class="title">Build the project</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell"> $ ./mvnw clean package</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now we are ready to run the application:</p>
</div>
<div class="listingblock">
<div class="title">Run the Spring Boot application</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell"> $ java -jar coherence-spring-demo-boot/target/coherence-spring-demo-boot-1.0.0-SNAPSHOT.jar</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="interacting-with-the-cache"><a class="anchor" href="#interacting-with-the-cache"></a>2.2. Interacting with the Cache</h3>
<div class="paragraph">
<p>Once the application is started, the embedded database is empty. Let&#8217;s create an event with 2 people added to them using
<a href="https://curl.se/docs/manual.html">curl</a>:</p>
</div>
<div class="listingblock">
<div class="title">Create the first event</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell"> $ curl --request POST 'http://localhost:8080/api/events?title=First%20Event&amp;date=2020-11-30'</code></pre>
</div>
</div>
<div class="paragraph">
<p>This call will create and persist an <code>Event</code> to the database. However, there is more going on. The created <code>Event</code> is also
added to the Coherence Cache. The magic is happening in the Service layer, specifically in
<code>DefaultEventService#createAndStoreEvent()</code>, which is annotated with <code>@CachePut(cacheNames="events", key="#result.id")</code>.</p>
</div>
<div class="paragraph">
<p>The <code>cacheNames</code> attribute of the <code>@CachePut</code> annotation indicates the name of the underlying cache to use. As caches are
basically just a Map, we also need a key. In this case we use the expression <code>#result.id</code> to retrieve the primary key of
the <code>Event</code> as it was persisted. Thus, the saved <code>Event</code> is added to the cache named <code>events</code> and ultimately also
returned and printed to the console:</p>
</div>
<div class="listingblock">
<div class="title">Return result of the created event</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json"> {
   "id" : 1,
   "title" : "First Event",
   "date" : "2020-11-30T00:00:00.000+00:00"
 }</code></pre>
</div>
</div>
<div class="paragraph">
<p>We see that an Event with the id <code>1</code> was successfully created. Let&#8217;s verify that the <em>cache put</em> worked by looking at the
chache&#8217;s statistics:</p>
</div>
<div class="listingblock">
<div class="title">Retrieving Cache Statistics</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell"> $ curl --request GET 'http://localhost:8080/api/statistics/events'</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the console you should see some basic statistics being printed including <code>totalPuts : 1</code>:</p>
</div>
<div class="listingblock">
<div class="title">Cache Statistic Results</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json"> {
   "averageMissMillis" : 0.0,
   "cachePrunesMillis" : 0,
   "averagePruneMillis" : 0.0,
   "totalGetsMillis" : 0,
   "averageGetMillis" : 0.0,
   "totalPutsMillis" : 11,
   "averagePutMillis" : 11.0,
   "cacheHitsMillis" : 0,
   "averageHitMillis" : 0.0,
   "cacheMissesMillis" : 0,
   "cacheHits" : 0,
   "cacheMisses" : 0,
   "hitProbability" : 0.0,
   "totalPuts" : 1,
   "totalGets" : 0,
   "cachePrunes" : 0
 }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Next, lets retrieve the Event using id 1:</p>
</div>
<div class="listingblock">
<div class="title">Retrieve Event</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell"> curl --request GET 'http://localhost:8080/api/events/1'</code></pre>
</div>
</div>
<div class="paragraph">
<p>The Event is returned. Did you notice? No SQL queries were executed as the value was directly retrieved from the Cache.
Let&#8217;s check the statistics again by executing:</p>
</div>
<div class="listingblock">
<div class="title">Retrieve Cache Statistics</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell"> curl --request GET 'http://localhost:8080/api/statistics/events'</code></pre>
</div>
</div>
<div class="paragraph">
<p>We will see now how values are being returned from the cache by seeing increasing cacheHits, e.g. <code>"cacheHits" : 1,</code>.
Let&#8217;s evict our Event with id 1 from the cache named events:</p>
</div>
<div class="listingblock">
<div class="title">Evict Event</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell"> curl --request DELETE 'http://localhost:8080/api/events/1'</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you now retrieve the event again using:</p>
</div>
<div class="listingblock">
<div class="title">Retrieve Event</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell"> curl --request GET 'http://localhost:8080/api/events/1'</code></pre>
</div>
</div>
<div class="paragraph">
<p>you will see an SQL query executed in the console, re-populating the cache. Feel free to play along with the Rest API. We
can for example add people:</p>
</div>
<div class="listingblock">
<div class="title">Add people</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell"> curl --request POST 'http://localhost:8080/api/people?firstName=Conrad&amp;lastName=Zuse&amp;age=85'
 curl --request POST 'http://localhost:8080/api/people?firstName=Alan&amp;lastName=Turing&amp;age=41'</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or assign people to events:</p>
</div>
<div class="listingblock">
<div class="title">Assign People to Events</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell"> curl --request POST 'http://localhost:8080/api/people/2/add-to-event/1'
 curl --request POST 'http://localhost:8080/api/people/3/add-to-event/1'</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="behind-the-scenes"><a class="anchor" href="#behind-the-scenes"></a>2.3. Behind the Scenes</h3>
<div class="paragraph">
<p>What is involved to make this all work? Using Spring Boot, the setup is incredibly simple. We take advantage of Spring Boot&#8217;s
<a href="https://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#using-boot-auto-configuration">AutoConfiguration</a>
capabilities, and the sensible defaults provided by <em>Coherence Spring</em>.</p>
</div>
<div class="paragraph">
<p>In order to activate AutoConfiguration for Coherence Spring you need to add the <code>coherence-spring-boot-starter</code>
dependency as well as the desired dependency for Coherence.</p>
</div>
<div class="listingblock">
<div class="title">POM configuration</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml"> &lt;dependency&gt;
     &lt;groupId&gt;com.oracle.coherence.spring&lt;/groupId&gt;
     &lt;artifactId&gt;coherence-spring-boot-starter&lt;/artifactId&gt; <i class="conum" data-value="1"></i><b>(1)</b>
     &lt;version&gt;3.0.0-SNAPSHOT&lt;/version&gt;
 &lt;/dependency&gt;
 &lt;dependency&gt;
     &lt;groupId&gt;com.oracle.coherence.ce&lt;/groupId&gt;
     &lt;artifactId&gt;coherence&lt;/artifactId&gt;                     <i class="conum" data-value="2"></i><b>(2)</b>
     &lt;version&gt;20.12&lt;/version&gt;
 &lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Activate Autoconfiguration by adding the <code>coherence-spring-boot-starter</code> dependency</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Add the desired version of Coherence (CE or Commercial)</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In this quickstart example we are using Spring&#8217;s Caching abstraction and therefore, we
use the <code>spring-boot-starter-cache</code> dependency as well:</p>
</div>
<div class="listingblock">
<div class="title">POM configuration for Spring Cache Abstraction</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml"> &lt;dependency&gt;
     &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
     &lt;artifactId&gt;spring-boot-starter-cache&lt;/artifactId&gt;
 &lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>For caching you also must activate caching using the <code>@EnableCaching</code> annotation.</p>
</div>
<div class="listingblock">
<div class="title">Spring Boot App configuration</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java"> @SpringBootApplication
 @EnableCaching                                             <i class="conum" data-value="1"></i><b>(1)</b>
 public class CoherenceSpringBootDemoApplication {

     public static void main(String[] args) {
         SpringApplication.run(CoherenceSpringBootDemoApplication.class, args);
     }

 }</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Activate the Spring Cache Abstraction</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Please see the relevant chapter on
<a href="https://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#boot-features-caching">Caching</a> in the Spring Boot
reference guide.</p>
</div>
<div class="paragraph">
<p>With <code>@EnableCaching</code> in place, Coherence&#8217;s autoconfiguration will also provide a <code>CoherenceCacheManager</code> bean to the
application context.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="coherence-spring"><a class="anchor" href="#coherence-spring"></a>3. Coherence Spring Core</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section dives into the Coherence Spring Core module. Coherence Spring Core
provides the basic support for the <a href="https://spring.io/projects/spring-framework">Spring Framework</a>.</p>
</div>
<div class="sect2">
<h3 id="coherence-spring-introduction"><a class="anchor" href="#coherence-spring-introduction"></a>3.1. Getting Started</h3>
<div class="paragraph">
<p>The main building block for setting up Coherence for Spring is the <code>@EnableCoherence</code> annotation.
This annotation will import the <code>CoherenceSpringConfiguration</code> under the covers. Therefore, you can alternative also declare
<code>@Import(CoherenceSpringConfiguration.class)</code> instead.</p>
</div>
<div class="paragraph">
<p>Without providing any further configuration various defaults are applied.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="spring-cache"><a class="anchor" href="#spring-cache"></a>4. Coherence Spring Cache</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section dives into the Coherence Spring Cache module. It explains how to use
Coherence&#8217;s support for the Spring Framework&#8217;s <a href="https://docs.spring.io/spring-framework/docs/current/reference/html/integration.html#cache">Cache Abstraction</a>.</p>
</div>
<div class="sect2">
<h3 id="spring-cache-introduction"><a class="anchor" href="#spring-cache-introduction"></a>4.1. Introduction</h3>
<div class="paragraph">
<p>Spring provides its own cache abstraction, allowing you to add caching to
Java methods. Coherence Spring provides an implementation of this abstraction for
Oracle Coherence.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Spring&#8217;s Cache abstraction also supports <a href="https://jcp.org/en/jsr/detail?id=107">JSR-107</a> which is also supported by
Oracle Coherence. As such you have another alternative for setting up caching.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If you are using JPA/Hibernate you may also consider using the Coherence support for Hibernate&#8217;s second-level cache SPI,
which is provided by the <a href="https://github.com/coherence-community/coherence-hibernate">Coherence Hibernate project</a>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="spring-cache-configuration"><a class="anchor" href="#spring-cache-configuration"></a>4.2. Configuring Coherence Cache for Spring</h3>
<div class="paragraph">
<p>As a start, please familiarize yourself with Spring&#8217;s Cache Abstraction by reading the
<a href="https://docs.spring.io/spring-framework/docs/current/reference/html/integration.html#cache">relevant section</a>
of Spring&#8217;s reference documentation.</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties"></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">example:
  property:
    alpha: a</code></pre>
</div>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties"></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">spring:
  devtools:
    restart:
      exclude: "static/**,public/**"</code></pre>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 1. Creating a CoherenceInstance</div>
<div class="content">
<div class="listingblock primary">
<div class="title">Java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Configuration
@EnableCaching
public class CacheConfiguration {

    @Bean
    public CoherenceInstance coherenceInstance() {
      return new CoherenceInstance();
    }

    @Bean
    public CacheManager cacheManager(CoherenceInstance coherenceInstance) {
      return new CoherenceCacheManager(coherenceInstance);
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">XML</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;beans xmlns="http://www.springframework.org/schema/beans"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xmlns:cache="http://www.springframework.org/schema/cache"
  xsi:schemaLocation="
    http://www.springframework.org/schema/beans https://www.springframework.org/schema/beans/spring-beans.xsd
    http://www.springframework.org/schema/cache https://www.springframework.org/schema/cache/spring-cache.xsd"&gt;

  &lt;cache:annotation-driven/&gt;

  &lt;bean id="coherenceInstance" class="com.oracle.coherence.spring.CoherenceInstance"/&gt;

  &lt;bean id="cacheManager" class="com.oracle.coherence.spring.cache.CoherenceCacheManager"&gt;
    &lt;constructor-arg ref="coherenceInstance"/&gt;
  &lt;/bean&gt;
&lt;/beans&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="spring-session"><a class="anchor" href="#spring-session"></a>5. Coherence Spring Session</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section dives into the Coherence Spring Session module. It explains how to use
Coherence&#8217;s support for <a href="https://docs.spring.io/spring-session/docs/curent/reference/html5/">Spring Session</a>.</p>
</div>
<div class="sect2">
<h3 id="spring-session-introduction"><a class="anchor" href="#spring-session-introduction"></a>5.1. Getting Started</h3>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="spring-data"><a class="anchor" href="#spring-data"></a>6. Coherence Spring Data</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section dives into the Coherence Spring Data module. It explains how to use
Coherence&#8217;s support for <a href="https://docs.spring.io/spring-session/docs/curent/reference/html5/">Spring Data</a> repositories.</p>
</div>
<div class="sect2">
<h3 id="spring-data-introduction"><a class="anchor" href="#spring-data-introduction"></a>6.1. Getting Started</h3>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="spring-boot"><a class="anchor" href="#spring-boot"></a>7. Coherence Spring Boot</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section dives into the Coherence Spring Boot module. It explains how to use
Coherence&#8217;s dedicated support for <a href="https://docs.spring.io/spring-boot/docs/current/reference/html/">Spring Boot</a>, e.g. Autoconfiguration.</p>
</div>
<div class="sect2">
<h3 id="spring-boot-getting-started"><a class="anchor" href="#spring-boot-getting-started"></a>7.1. Getting Started</h3>
<div class="paragraph">
<p>In order to start using Coherence with Spring Boot you have to add the <code>coherence-spring-boot-starter</code> dependency as well
as the desired version of Coherence.</p>
</div>
<div class="listingblock">
<div class="title">Maven</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependencies&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;com.oracle.coherence.spring&lt;/groupId&gt;
        &lt;artifactId&gt;coherence-spring-boot-starter&lt;/artifactId&gt;
        &lt;version&gt;3.0.0-SNAPSHOT&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;com.oracle.coherence.ce&lt;/groupId&gt;
        &lt;artifactId&gt;coherence&lt;/artifactId&gt;
        &lt;version&gt;20.12&lt;/version&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    compile("com.oracle.coherence.spring:coherence-spring-boot-starter:3.0.0-SNAPSHOT")
    compile("com.oracle.coherence.ce:coherence:20.12")
}</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
As Coherence Spring takes advantage of the new Coherence Bootstrap API, it requires Oracle Coherence CE version
<code>20.12</code> or higher.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="spring-boot-using-coherence"><a class="anchor" href="#spring-boot-using-coherence"></a>7.2. Using Coherence with Spring Boot</h3>
<div class="paragraph">
<p>By adding the <code>coherence-spring-boot-starter</code> dependency, AutoConfiguration will be activated via the <code>CoherenceAutoConfiguration</code>
class. This will also bind the <code>CoherenceProperties</code> for further configuration. The configuration for Spring Boot&#8217;s
Coherence support may look like the following:</p>
</div>
<div class="listingblock primary">
<div class="title">Example YAML configuration (Properties)</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties"></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Example YAML configuration (Yaml)</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">coherence:
  logging:
    destination: slf4j
    logger-name: MyCoherence
  sessions:
  - name: default
    config: "coherence-cache-config.xml"
    priority: 1
  - name: test
    config: "test-coherence-config.xml"
    priority: 2
  properties:
    coherence.log.limit: 400
    coherence.log.level: 1</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following configuration properties are available.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Coherence Configuration Properties</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Key</th>
<th class="tableblock halign-left valign-top">Default Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">coherence.logging.destination</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The type of the logging destination. Default to <code>slf4j</code> if not set.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">coherence.logging.severity-level</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies which logged messages are emitted to the log destination. The legal values are <code>-1</code> to <code>9</code>.
No messages are emitted if <code>-1</code> is specified. More log messages are emitted as the log level is increased.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">coherence.logging.logger-name</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">coherence.logging.message-format</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">coherence.logging.character-limit</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">coherence.properties.*</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any native Coherence properties</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">coherence.sessions[0].name</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">coherence.sessions[0].type</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Represents the various session type that can be configured: CLIENT, SERVER, GRPC</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">coherence.sessions[0].config</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The Coherence cache configuration URI for the session</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">coherence.sessions[0].priority</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The priority order to be used when starting the session. Sessions will be started with the lowest priority first.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">coherence.sessions[0].scope-name</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The scope name for the session.</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
All but the session property are translated into native Coherence properties. If both
Spring Boot property AND a native property <code>coherence.properties.*</code> are configured, the Spring Boot
property is used.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For a list of available native properties, please consult the reference guide chapter on
<a href="https://docs.oracle.com/en/middleware/standalone/coherence/14.1.1.0/develop-applications/system-property-overrides.html#GUID-32230D28-4976-4147-A887-0A0120FF5C7E">System Property Overrides</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="spring-boot-customize-coherence"><a class="anchor" href="#spring-boot-customize-coherence"></a>7.3. Customize Coherence</h3>

</div>
<div class="sect2">
<h3 id="spring-boot-caching"><a class="anchor" href="#spring-boot-caching"></a>7.4. Using Coherence as Spring Caching Provider</h3>
<div class="paragraph">
<p>If caching is enabled via <code>@EnableCaching</code>, Coherence Autoconfiguration will it automatically provide a <code>CacheManager</code> to
the ApplicationContext, however only if no <code>CacheManager</code> was configured explicitly beforehand.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="appendix"><a class="anchor" href="#appendix"></a>8. Appendices</h2>
<div class="sectionbody">

</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2021-02-17 05:08:11 UTC
</div>
</div>
<script type="text/javascript" src="js/tocbot/tocbot.min.js"></script>
<script type="text/javascript" src="js/toc.js"></script>
<link rel="stylesheet" href="js/highlight/styles/github.min.css">
<script src="js/highlight/highlight.min.js"></script>
<script>hljs.initHighlighting()</script>
</body>
</html>